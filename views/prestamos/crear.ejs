<%- include('../Parcial/header') %>

<div class="page-header">
  <h2>➕ Registrar Nuevo Préstamo</h2>
</div>

<div class="form-contenedor">
  <% if (libros.length === 0) { %>
    <p class="empty-message">No hay libros disponibles para préstamo.</p>
    <a href="/libros/nuevo" class="btn">Agregar Libro</a>
  <% } else { %>
    <form action="/prestamos" method="POST">
      <div class="form-group">
        <label>Libro:</label>
        <select name="libroId" required>
          <option value="">Selecciona un libro</option>
          <% libros.forEach(libro => { %>
            <option value="<%= libro._id %>"><%= libro.titulo %> - <%= libro.autor %></option>
          <% }); %>
        </select>
      </div>

      <div class="form-group">
        <label>Nombre del Usuario:</label>
        <input type="text" name="nombreUsuario" required placeholder="Ej: Juan Pérez">
      </div>

      <div class="form-group">
        <label>Fecha de Devolución:</label>
        <input type="date" name="fechaDevolucion" value="<%= fechaSugerida %>" required>
        <small>Fecha sugerida: <%= diasMaxPrestamo %> días desde hoy</small>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn">Registrar Préstamo</button>
        <a href="/prestamos" class="btn btn-secondary">Cancelar</a>
      </div>
    </form>
  <% } %>
</div>

<%- include('../Parcial/footer') %>